var H=Object.defineProperty;var T=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var N=(e,t,o)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,P=(e,t)=>{for(var o in t||(t={}))G.call(t,o)&&N(e,o,t[o]);if(T)for(var o of T(t))J.call(t,o)&&N(e,o,t[o]);return e};var x=(e,t,o)=>new Promise((l,c)=>{var r=i=>{try{n(o.next(i))}catch(a){c(a)}},s=i=>{try{n(o.throw(i))}catch(a){c(a)}},n=i=>i.done?l(i.value):Promise.resolve(i.value).then(r,s);n((o=o.apply(e,t)).next())});import{n as Y,g as F,z as E,G as Z,c as C,H as Q,B as S,Z as B,h as v,$ as k,at as X,N as ee,aa as te,bK as oe,q as _,a5 as w,p as z,m as U,bL as ne,A as g,Y as ie,bM as se,bi as ae,aJ as le,bN as re,P as O,o as ce,b as ue,bO as de,w as b,d as ve,bD as j,e as R,a0 as $,f as pe,aj as fe,R as me,bP as ge,bC as he}from"./index-65c853c8.js";import{u as I}from"./Input-a2b3f6ce.js";const q=Y("n-popconfirm"),A={positiveText:String,negativeText:String,showIcon:{type:Boolean,default:!0},onPositiveClick:{type:Function,required:!0},onNegativeClick:{type:Function,required:!0}},V=oe(A),Pe=F({name:"NPopconfirmPanel",props:A,setup(e){const{localeRef:t}=I("Popconfirm"),{inlineThemeDisabled:o}=E(),{mergedClsPrefixRef:l,mergedThemeRef:c,props:r}=Z(q),s=C(()=>{const{common:{cubicBezierEaseInOut:i},self:{fontSize:a,iconSize:d,iconColor:u}}=c.value;return{"--n-bezier":i,"--n-font-size":a,"--n-icon-size":d,"--n-icon-color":u}}),n=o?Q("popconfirm-panel",void 0,s,r):void 0;return Object.assign(Object.assign({},I("Popconfirm")),{mergedClsPrefix:l,cssVars:o?void 0:s,localizedPositiveText:C(()=>e.positiveText||t.value.positiveText),localizedNegativeText:C(()=>e.negativeText||t.value.negativeText),positiveButtonProps:S(r,"positiveButtonProps"),negativeButtonProps:S(r,"negativeButtonProps"),handlePositiveClick(i){e.onPositiveClick(i)},handleNegativeClick(i){e.onNegativeClick(i)},themeClass:n==null?void 0:n.themeClass,onRender:n==null?void 0:n.onRender})},render(){var e;const{mergedClsPrefix:t,showIcon:o,$slots:l}=this,c=B(l.action,()=>this.negativeText===null&&this.positiveText===null?[]:[this.negativeText!==null&&v(k,Object.assign({size:"small",onClick:this.handleNegativeClick},this.negativeButtonProps),{default:()=>this.localizedNegativeText}),this.positiveText!==null&&v(k,Object.assign({size:"small",type:"primary",onClick:this.handlePositiveClick},this.positiveButtonProps),{default:()=>this.localizedPositiveText})]);return(e=this.onRender)===null||e===void 0||e.call(this),v("div",{class:[`${t}-popconfirm__panel`,this.themeClass],style:this.cssVars},X(l.default,r=>o||r?v("div",{class:`${t}-popconfirm__body`},o?v("div",{class:`${t}-popconfirm__icon`},B(l.icon,()=>[v(ee,{clsPrefix:t},{default:()=>v(te,null)})])):null,r):null),c?v("div",{class:[`${t}-popconfirm__action`]},c):null)}}),Ce=_("popconfirm",[w("body",`
 font-size: var(--n-font-size);
 display: flex;
 align-items: center;
 flex-wrap: nowrap;
 position: relative;
 `,[w("icon",`
 display: flex;
 font-size: var(--n-icon-size);
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 margin: 0 8px 0 0;
 `)]),w("action",`
 display: flex;
 justify-content: flex-end;
 `,[z("&:not(:first-child)","margin-top: 8px"),_("button",[z("&:not(:last-child)","margin-right: 8px;")])])]),be=Object.assign(Object.assign(Object.assign({},U.props),re),{positiveText:String,negativeText:String,showIcon:{type:Boolean,default:!0},trigger:{type:String,default:"click"},positiveButtonProps:Object,negativeButtonProps:Object,onPositiveClick:Function,onNegativeClick:Function}),Se=F({name:"Popconfirm",props:be,slots:Object,__popover__:!0,setup(e){const{mergedClsPrefixRef:t}=E(),o=U("Popconfirm","-popconfirm",Ce,ne,e,t),l=g(null);function c(n){var i;if(!(!((i=l.value)===null||i===void 0)&&i.getMergedShow()))return;const{onPositiveClick:a,"onUpdate:show":d}=e;Promise.resolve(a?a(n):!0).then(u=>{var p;u!==!1&&((p=l.value)===null||p===void 0||p.setShow(!1),d&&O(d,!1))})}function r(n){var i;if(!(!((i=l.value)===null||i===void 0)&&i.getMergedShow()))return;const{onNegativeClick:a,"onUpdate:show":d}=e;Promise.resolve(a?a(n):!0).then(u=>{var p;u!==!1&&((p=l.value)===null||p===void 0||p.setShow(!1),d&&O(d,!1))})}return ie(q,{mergedThemeRef:o,mergedClsPrefixRef:t,props:e}),{setShow(n){var i;(i=l.value)===null||i===void 0||i.setShow(n)},syncPosition(){var n;(n=l.value)===null||n===void 0||n.syncPosition()},mergedTheme:o,popoverInstRef:l,handlePositiveClick:c,handleNegativeClick:r}},render(){const{$slots:e,$props:t,mergedTheme:o}=this;return v(le,Object.assign({},ae(t,V),{theme:o.peers.Popover,themeOverrides:o.peerOverrides.Popover,internalExtraClass:["popconfirm"],ref:"popoverInstRef"}),{trigger:e.trigger,default:()=>{const l=se(t,V);return v(Pe,Object.assign({},l,{onPositiveClick:this.handlePositiveClick,onNegativeClick:this.handleNegativeClick}),e)}})}}),ye={flex:"","justify-end":""},Be={__name:"CrudModal",props:{width:{type:String,default:"600px"},title:{type:String,default:""},showFooter:{type:Boolean,default:!0},visible:{type:Boolean,required:!0},loading:{type:Boolean,default:!1}},emits:["update:visible","onSave"],setup(e,{emit:t}){const o=e,l=t,c=C({get(){return o.visible},set(r){l("update:visible",r)}});return(r,s)=>{const n=k,i=ge;return ce(),ue(i,{show:pe(c),"onUpdate:show":s[2]||(s[2]=a=>fe(c)?c.value=a:null),style:me({width:e.width}),preset:"card",title:e.title,size:"huge",bordered:!1,"mask-closable":!1},de({default:b(()=>[j(r.$slots,"default")]),_:2},[e.showFooter?{name:"footer",fn:b(()=>[ve("footer",ye,[j(r.$slots,"footer",{},()=>[R(n,{onClick:s[0]||(s[0]=a=>c.value=!1)},{default:b(()=>[...s[3]||(s[3]=[$("取消",-1)])]),_:1}),R(n,{loading:e.loading,"ml-20":"",type:"primary",onClick:s[1]||(s[1]=a=>l("save"))},{default:b(()=>[...s[4]||(s[4]=[$("保存",-1)])]),_:1},8,["loading"])])])]),key:"0"}:void 0]),1032,["show","style","title"])}}},xe={view:"查看",edit:"编辑",add:"新增"};function _e({name:e,initForm:t={},doCreate:o,doDelete:l,doUpdate:c,refresh:r}){const s=g(!1),n=g(""),i=C(()=>xe[n.value]+e),a=g(!1),d=g(null),u=g(P({},t));function p(){n.value="add",s.value=!0,u.value=P({},t)}function D(f){n.value="edit",s.value=!0,u.value=P({},f)}function K(f){n.value="view",s.value=!0,u.value=P({},f)}function L(...f){var h;if(!["edit","add"].includes(n.value)){s.value=!1;return}(h=d.value)==null||h.validate(W=>x(this,null,function*(){if(W)return;const y={add:{api:()=>o(u.value),cb:()=>{f.forEach(m=>m&&m())},msg:()=>$message.success("新增成功")},edit:{api:()=>c(u.value),cb:()=>{f.forEach(m=>m&&m())},msg:()=>$message.success("编辑成功")}}[n.value];try{a.value=!0;const m=yield y.api();y.cb(),y.msg(),a.value=s.value=!1,m&&r(m)}catch(m){a.value=!1}}))}function M(){return x(this,arguments,function*(f={}){if(!he(f))try{a.value=!0;const h=yield l(f);$message.success("删除成功"),a.value=!1,r(h)}catch(h){a.value=!1}})}return{modalVisible:s,modalAction:n,modalTitle:i,modalLoading:a,handleAdd:p,handleDelete:M,handleEdit:D,handleView:K,handleSave:L,modalForm:u,modalFormRef:d}}export{Se as N,Be as _,_e as u};
