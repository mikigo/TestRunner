import{j as $e,k as He,bF as We,bG as Ge,bH as Je,p as qe,q as U,a5 as V,v as Ye,g as Ze,A as m,z as Qe,aJ as Xe,B as j,C as D,c as u,bI as et,Y as tt,m as ie,H as nt,aL as z,I as at,h as c,aC as lt,aD as rt,aE as ot,T as it,J as dt,aF as st,aA as ae,Z as ct,P as b,aG as ut,aM as ht,aN as le}from"./index-96e58cca.js";import{c as ft,t as gt,u as vt,_ as mt,a as yt}from"./Tree-a7a18cb3.js";import{u as pt}from"./Input-22abf345.js";import{u as bt,k as St,l as wt,F as xt}from"./TheIcon-880786b2.js";function kt(t){const{popoverColor:h,boxShadow2:o,borderRadius:s,heightMedium:i,dividerColor:y,textColor2:K}=t;return{menuPadding:"4px",menuColor:h,menuBoxShadow:o,menuBorderRadius:s,menuHeight:`calc(${i} * 7.6)`,actionDividerColor:y,actionTextColor:K,actionPadding:"8px 12px",headerDividerColor:y,headerTextColor:K,headerPadding:"8px 12px"}}const Ct=$e({name:"TreeSelect",common:He,peers:{Tree:We,Empty:Ge,InternalSelection:Je},self:kt}),Tt=Ct,Kt=qe([U("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),U("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[U("tree","max-height: var(--n-menu-height);"),V("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),V("header",`
 padding: var(--n-header-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-header-divider-color);
 color: var(--n-header-text-color);
 `),V("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),Ye()])]);function re(t,h){const{rawNode:o}=t;return Object.assign(Object.assign({},o),{label:o[h],value:t.key})}function oe(t,h,o,s){const{rawNode:i}=t;return Object.assign(Object.assign({},i),{value:t.key,label:h.map(y=>y.rawNode[s]).join(o)})}const Ft=Object.assign(Object.assign(Object.assign(Object.assign({},ie.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:z.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function,ellipsisTagPopoverProps:Object}),yt),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,watchProps:Array,getChildren:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean}),Bt=Ze({name:"TreeSelect",props:Ft,slots:Object,setup(t){const h=m(null),o=m(null),s=m(null),i=m(null),{mergedClsPrefixRef:y,namespaceRef:K,inlineThemeDisabled:g}=Qe(t),{localeRef:A}=pt("Select"),{mergedSizeRef:S,mergedDisabledRef:N,mergedStatusRef:de,nTriggerFormBlur:se,nTriggerFormChange:ce,nTriggerFormFocus:ue,nTriggerFormInput:he}=Xe(t),$=m(t.defaultValue),fe=j(t,"value"),w=D(fe,$),H=m(t.defaultShow),ge=j(t,"show"),x=D(ge,H),R=m(""),ve=u(()=>{const{filter:e}=t;if(e)return e;const{labelField:n}=t;return(l,a)=>l.length?a[n].toLowerCase().includes(l.toLowerCase()):!0}),k=u(()=>et(t.options,ft(t.keyField,t.childrenField,t.disabledField,void 0))),{value:I}=w,W=m(t.checkable?null:Array.isArray(I)&&I.length?I[I.length-1]:null),B=u(()=>t.multiple&&t.cascade&&t.checkable),G=m(t.defaultExpandAll?void 0:t.defaultExpandedKeys||t.expandedKeys),me=j(t,"expandedKeys"),ye=D(me,G),P=m(!1),pe=u(()=>{const{placeholder:e}=t;return e!==void 0?e:A.value.placeholder}),J=u(()=>{const{value:e}=w;return t.multiple?Array.isArray(e)?e:[]:e===null||Array.isArray(e)?[]:[e]}),be=u(()=>t.checkable?[]:J.value),Se=u(()=>{const{multiple:e,showPath:n,separator:l,labelField:a}=t;if(e)return null;const{value:r}=w;if(!Array.isArray(r)&&r!==null){const{value:d}=k,v=d.getNode(r);if(v!==null)return n?oe(v,d.getPath(r).treeNodePath,l,a):re(v,a)}return null}),we=u(()=>{const{multiple:e,showPath:n,separator:l}=t;if(!e)return null;const{value:a}=w;if(Array.isArray(a)){const r=[],{value:d}=k,{checkedKeys:v}=d.getCheckedKeys(a,{checkStrategy:t.checkStrategy,cascade:B.value,allowNotLoaded:t.allowCheckingNotLoaded}),{labelField:f}=t;return v.forEach(_=>{const O=d.getNode(_);O!==null&&r.push(n?oe(O,d.getPath(_).treeNodePath,l,f):re(O,f))}),r}return[]});function M(){var e;(e=o.value)===null||e===void 0||e.focus()}function q(){var e;(e=o.value)===null||e===void 0||e.focusInput()}function Y(e){const{onUpdateShow:n,"onUpdate:show":l}=t;n&&b(n,e),l&&b(l,e),H.value=e}function C(e,n,l){const{onUpdateValue:a,"onUpdate:value":r}=t;a&&b(a,e,n,l),r&&b(r,e,n,l),$.value=e,he(),ce()}function xe(e,n){const{onUpdateIndeterminateKeys:l,"onUpdate:indeterminateKeys":a}=t;l&&b(l,e,n),a&&b(a,e,n)}function ke(e,n,l){const{onUpdateExpandedKeys:a,"onUpdate:expandedKeys":r}=t;a&&b(a,e,n,l),r&&b(r,e,n,l),G.value=e}function Z(e){const{onFocus:n}=t;n&&n(e),ue()}function Q(e){p();const{onBlur:n}=t;n&&n(e),se()}function p(){Y(!1)}function E(){N.value||(R.value="",Y(!0),t.filterable&&q())}function Ce(){R.value=""}function Te(e){var n;x.value&&(!((n=o.value)===null||n===void 0)&&n.$el.contains(ut(e))||p())}function Ke(){N.value||(x.value?t.filterable||p():E())}function T(e){const{value:{getNode:n}}=k;return e.map(l=>{var a;return((a=n(l))===null||a===void 0?void 0:a.rawNode)||null})}function Fe(e,n,l){const a=T(e),r=l.action==="check"?"select":"unselect",d=l.node;t.multiple?(C(e,a,{node:d,action:r}),t.filterable&&(q(),t.clearFilterAfterSelect&&(R.value=""))):(e.length?C(e[0],a[0]||null,{node:d,action:r}):C(null,null,{node:d,action:r}),p(),M())}function Re(e){t.checkable&&xe(e,T(e))}function Pe(e){var n;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||(P.value=!0,Z(e))}function Oe(e){var n;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||(P.value=!1,Q(e))}function Ie(e){var n,l,a;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||!((a=(l=o.value)===null||l===void 0?void 0:l.$el)===null||a===void 0)&&a.contains(e.relatedTarget)||(P.value=!0,Z(e))}function Be(e){var n,l,a;!((n=i.value)===null||n===void 0)&&n.contains(e.relatedTarget)||!((a=(l=o.value)===null||l===void 0?void 0:l.$el)===null||a===void 0)&&a.contains(e.relatedTarget)||(P.value=!1,Q(e))}function Me(e){e.stopPropagation();const{multiple:n}=t;!n&&t.filterable&&p(),n?C([],[],{node:null,action:"clear"}):C(null,null,{node:null,action:"clear"})}function _e(e){const{value:n}=w;if(Array.isArray(n)){const{value:l}=k,{checkedKeys:a}=l.getCheckedKeys(n,{cascade:B.value,allowNotLoaded:t.allowCheckingNotLoaded}),r=a.findIndex(d=>d===e.value);if(~r){const d=a[r],v=T([d])[0];if(t.checkable){const{checkedKeys:f}=l.uncheck(e.value,a,{checkStrategy:t.checkStrategy,cascade:B.value,allowNotLoaded:t.allowCheckingNotLoaded});C(f,T(f),{node:v,action:"delete"})}else{const f=Array.from(a);f.splice(r,1),C(f,T(f),{node:v,action:"delete"})}}}}function Ae(e){const{value:n}=e.target;R.value=n}function X(e){const{value:n}=s;return n?n.handleKeydown(e):{enterBehavior:null}}function Ne(e){if(e.key==="Enter"){if(x.value){const{enterBehavior:n}=X(e);if(!t.multiple)switch(n){case"default":case"toggleSelect":p(),M();break}}else E();e.preventDefault()}else e.key==="Escape"?x.value&&(ht(e),p(),M()):x.value?X(e):e.key==="ArrowDown"&&E()}function Ee(){p(),M()}function Le(e){!le(e,"action")&&!le(e,"header")&&e.preventDefault()}const Ue=u(()=>{const{renderTag:e}=t;if(e)return function({option:l,handleClose:a}){const{value:r}=l;if(r!==void 0){const d=k.value.getNode(r);if(d)return e({option:d.rawNode,handleClose:a})}return r}});tt(gt,{pendingNodeKeyRef:W,dataTreeMate:k});function ee(){var e;x.value&&((e=h.value)===null||e===void 0||e.syncPosition())}bt(i,ee);const Ve=vt(t),te=u(()=>{if(t.checkable){const e=w.value;return t.multiple&&Array.isArray(e)?k.value.getCheckedKeys(e,{cascade:t.cascade,checkStrategy:Ve.value,allowNotLoaded:t.allowCheckingNotLoaded}):{checkedKeys:Array.isArray(e)||e===null?[]:[e],indeterminateKeys:[]}}return{checkedKeys:[],indeterminateKeys:[]}}),je={getCheckedData:()=>{const{checkedKeys:e}=te.value;return{keys:e,options:T(e)}},getIndeterminateData:()=>{const{indeterminateKeys:e}=te.value;return{keys:e,options:T(e)}},focus:()=>{var e;return(e=o.value)===null||e===void 0?void 0:e.focus()},focusInput:()=>{var e;return(e=o.value)===null||e===void 0?void 0:e.focusInput()},blur:()=>{var e;return(e=o.value)===null||e===void 0?void 0:e.blur()},blurInput:()=>{var e;return(e=o.value)===null||e===void 0?void 0:e.blurInput()}},L=ie("TreeSelect","-tree-select",Kt,Tt,t,y),ne=u(()=>{const{common:{cubicBezierEaseInOut:e},self:{menuBoxShadow:n,menuBorderRadius:l,menuColor:a,menuHeight:r,actionPadding:d,actionDividerColor:v,actionTextColor:f,headerDividerColor:_,headerPadding:O,headerTextColor:ze}}=L.value;return{"--n-menu-box-shadow":n,"--n-menu-border-radius":l,"--n-menu-color":a,"--n-menu-height":r,"--n-bezier":e,"--n-action-padding":d,"--n-action-text-color":f,"--n-action-divider-color":v,"--n-header-padding":O,"--n-header-text-color":ze,"--n-header-divider-color":_}}),F=g?nt("tree-select",void 0,ne,t):void 0,De=u(()=>{const{self:{menuPadding:e}}=L.value;return e});return Object.assign(Object.assign({},je),{menuElRef:i,mergedStatus:de,triggerInstRef:o,followerInstRef:h,treeInstRef:s,mergedClsPrefix:y,mergedValue:w,mergedShow:x,namespace:K,adjustedTo:z(t),isMounted:at(),focused:P,menuPadding:De,mergedPlaceholder:pe,mergedExpandedKeys:ye,treeSelectedKeys:be,treeCheckedKeys:J,mergedSize:S,mergedDisabled:N,selectedOption:Se,selectedOptions:we,pattern:R,pendingNodeKey:W,mergedCascade:B,mergedFilter:ve,selectionRenderTag:Ue,handleTriggerOrMenuResize:ee,doUpdateExpandedKeys:ke,handleMenuLeave:Ce,handleTriggerClick:Ke,handleMenuClickoutside:Te,handleUpdateCheckedKeys:Fe,handleUpdateIndeterminateKeys:Re,handleTriggerFocus:Pe,handleTriggerBlur:Oe,handleMenuFocusin:Ie,handleMenuFocusout:Be,handleClear:Me,handleDeleteOption:_e,handlePatternInput:Ae,handleKeydown:Ne,handleTabOut:Ee,handleMenuMousedown:Le,mergedTheme:L,cssVars:g?void 0:ne,themeClass:F==null?void 0:F.themeClass,onRender:F==null?void 0:F.onRender})},render(){const{mergedTheme:t,mergedClsPrefix:h,$slots:o}=this;return c("div",{class:`${h}-tree-select`},c(lt,null,{default:()=>[c(rt,null,{default:()=>c(St,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:h,theme:t.peers.InternalSelection,themeOverrides:t.peerOverrides.InternalSelection,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var s,i;return[(i=(s=this.$slots).arrow)===null||i===void 0?void 0:i.call(s)]}})}),c(ot,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===z.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>c(it,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var s;if(!this.mergedShow)return null;const{mergedClsPrefix:i,checkable:y,multiple:K,menuProps:g,options:A}=this;return(s=this.onRender)===null||s===void 0||s.call(this),dt(c("div",Object.assign({},g,{class:[`${i}-tree-select-menu`,g==null?void 0:g.class,this.themeClass],ref:"menuElRef",style:[(g==null?void 0:g.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),ae(o.header,S=>S?c("div",{class:`${i}-tree-select-menu__header`,"data-header":!0},S):null),c(mt,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,getChildren:this.getChildren,filter:this.mergedFilter,data:A,cancelable:K,labelField:this.labelField,keyField:this.keyField,disabledField:this.disabledField,childrenField:this.childrenField,theme:t.peers.Tree,themeOverrides:t.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,indent:this.indent,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:y,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,watchProps:this.watchProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,overrideDefaultNodeClickBehavior:this.overrideDefaultNodeClickBehavior,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>c("div",{class:`${i}-tree-select-menu__empty`},ct(o.empty,()=>[c(wt,{theme:t.peers.Empty,themeOverrides:t.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),ae(o.action,S=>S?c("div",{class:`${i}-tree-select-menu__action`,"data-action":!0},S):null),c(xt,{onFocus:this.handleTabOut})),[[st,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}});export{Bt as N};
