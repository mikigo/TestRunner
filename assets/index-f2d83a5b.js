var ne=(e,t,r)=>new Promise((i,a)=>{var u=f=>{try{c(r.next(f))}catch(v){a(v)}},s=f=>{try{c(r.throw(f))}catch(v){a(v)}},c=f=>f.done?i(f.value):Promise.resolve(f.value).then(u,s);c((r=r.apply(e,t)).next())});import{a$ as Le,c as D,A as R,E as $e,O as Z,g as K,G as ce,b0 as fe,z as he,aZ as Ge,X as We,D as qe,aF as Xe,b1 as Ve,Y,b2 as Ye,b3 as Ke,b4 as Qe,J as U,h as m,b5 as Je,T as Ce,b6 as ue,aB as Re,p as g,b7 as te,q as F,aI as A,a5 as L,s as Ze,I as et,m as xe,b8 as tt,C as pe,B as ee,b9 as me,ba as rt,H as ot,K as nt,L as at,P as G,bb as it,aH as st,bc as lt,n as dt,bd as ut,be as q,aY as Q,W as ze,i as ct,bf as ft,V as ht,bg as pt,bh as ve,ai as mt,a1 as P,o as ae,b as ie,w as _,f as p,$ as X,e as C,a0 as se,af as vt,aj as bt,aU as gt,aV as yt,ak as le}from"./index-96e58cca.js";import{_ as wt}from"./CommonPage-678180f0.js";import{_ as St}from"./QueryBarItem-3387149b.js";import{u as $t,_ as Ct,N as Rt}from"./useCRUD-bc08bbc2.js";import{g as xt,_ as zt,a as kt}from"./TheIcon-880786b2.js";import{_ as be}from"./Tree-a7a18cb3.js";import{N as J}from"./Input-22abf345.js";import{N as _t,a as ge}from"./FormItem-afa4ad0a.js";import{a as Bt,N as ye}from"./Tabs-5db5fd7a.js";import"./AppPage-8617562f.js";import"./Add-59f409d3.js";function Et(e){if(typeof e=="number")return{"":e.toString()};const t={};return e.split(/ +/).forEach(r=>{if(r==="")return;const[i,a]=r.split(":");a===void 0?t[""]=i:t[i]=a}),t}function W(e,t){var r;if(e==null)return;const i=Et(e);if(t===void 0)return i[""];if(typeof t=="string")return(r=i[t])!==null&&r!==void 0?r:i[""];if(Array.isArray(t)){for(let a=t.length-1;a>=0;--a){const u=t[a];if(u in i)return i[u]}return i[""]}else{let a,u=-1;return Object.keys(i).forEach(s=>{const c=Number(s);!Number.isNaN(c)&&t>=c&&c>=u&&(u=c,a=i[s])}),a}}const Nt={xs:0,s:640,m:1024,l:1280,xl:1536,"2xl":1920};function Tt(e){return`(min-width: ${e}px)`}const V={};function Dt(e=Nt){if(!Le)return D(()=>[]);if(typeof window.matchMedia!="function")return D(()=>[]);const t=R({}),r=Object.keys(e),i=(a,u)=>{a.matches?t.value[u]=!0:t.value[u]=!1};return r.forEach(a=>{const u=e[a];let s,c;V[u]===void 0?(s=window.matchMedia(Tt(u)),s.addEventListener?s.addEventListener("change",f=>{c.forEach(v=>{v(f,a)})}):s.addListener&&s.addListener(f=>{c.forEach(v=>{v(f,a)})}),c=new Set,V[u]={mql:s,cbs:c}):(s=V[u].mql,c=V[u].cbs),c.add(i),s.matches&&c.forEach(f=>{f(s,a)})}),$e(()=>{r.forEach(a=>{const{cbs:u}=V[e[a]];u.has(i)&&u.delete(i)})}),D(()=>{const{value:a}=t;return r.filter(u=>a[u])})}function Ot(e){var t;const r=(t=e.dirs)===null||t===void 0?void 0:t.find(({dir:i})=>i===Z);return!!(r&&r.value===!1)}const It=K({name:"NDrawerContent",inheritAttrs:!1,props:{blockScroll:Boolean,show:{type:Boolean,default:void 0},displayDirective:{type:String,required:!0},placement:{type:String,required:!0},contentClass:String,contentStyle:[Object,String],nativeScrollbar:{type:Boolean,required:!0},scrollbarProps:Object,trapFocus:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},showMask:{type:[Boolean,String],required:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,onClickoutside:Function,onAfterLeave:Function,onAfterEnter:Function,onEsc:Function},setup(e){const t=R(!!e.show),r=R(null),i=ce(fe);let a=0,u="",s=null;const c=R(!1),f=R(!1),v=D(()=>e.placement==="top"||e.placement==="bottom"),{mergedClsPrefixRef:M,mergedRtlRef:O}=he(e),x=Ge("Drawer",O,M),E=l,S=n=>{f.value=!0,a=v.value?n.clientY:n.clientX,u=document.body.style.cursor,document.body.style.cursor=v.value?"ns-resize":"ew-resize",document.body.addEventListener("mousemove",$),document.body.addEventListener("mouseleave",E),document.body.addEventListener("mouseup",l)},z=()=>{s!==null&&(window.clearTimeout(s),s=null),f.value?c.value=!0:s=window.setTimeout(()=>{c.value=!0},300)},T=()=>{s!==null&&(window.clearTimeout(s),s=null),c.value=!1},{doUpdateHeight:y,doUpdateWidth:h}=i,I=n=>{const{maxWidth:o}=e;if(o&&n>o)return o;const{minWidth:d}=e;return d&&n<d?d:n},N=n=>{const{maxHeight:o}=e;if(o&&n>o)return o;const{minHeight:d}=e;return d&&n<d?d:n};function $(n){var o,d;if(f.value)if(v.value){let b=((o=r.value)===null||o===void 0?void 0:o.offsetHeight)||0;const B=a-n.clientY;b+=e.placement==="bottom"?B:-B,b=N(b),y(b),a=n.clientY}else{let b=((d=r.value)===null||d===void 0?void 0:d.offsetWidth)||0;const B=a-n.clientX;b+=e.placement==="right"?B:-B,b=I(b),h(b),a=n.clientX}}function l(){f.value&&(a=0,f.value=!1,document.body.style.cursor=u,document.body.removeEventListener("mousemove",$),document.body.removeEventListener("mouseup",l),document.body.removeEventListener("mouseleave",E))}We(()=>{e.show&&(t.value=!0)}),qe(()=>e.show,n=>{n||l()}),$e(()=>{l()});const w=D(()=>{const{show:n}=e,o=[[Z,n]];return e.showMask||o.push([Xe,e.onClickoutside,void 0,{capture:!0}]),o});function k(){var n;t.value=!1,(n=e.onAfterLeave)===null||n===void 0||n.call(e)}return Ve(D(()=>e.blockScroll&&t.value)),Y(Ye,r),Y(Ke,null),Y(Qe,null),{bodyRef:r,rtlEnabled:x,mergedClsPrefix:i.mergedClsPrefixRef,isMounted:i.isMountedRef,mergedTheme:i.mergedThemeRef,displayed:t,transitionName:D(()=>({right:"slide-in-from-right-transition",left:"slide-in-from-left-transition",top:"slide-in-from-top-transition",bottom:"slide-in-from-bottom-transition"})[e.placement]),handleAfterLeave:k,bodyDirectives:w,handleMousedownResizeTrigger:S,handleMouseenterResizeTrigger:z,handleMouseleaveResizeTrigger:T,isDragging:f,isHoverOnResizeTrigger:c}},render(){const{$slots:e,mergedClsPrefix:t}=this;return this.displayDirective==="show"||this.displayed||this.show?U(m("div",{role:"none"},m(Je,{disabled:!this.showMask||!this.trapFocus,active:this.show,autoFocus:this.autoFocus,onEsc:this.onEsc},{default:()=>m(Ce,{name:this.transitionName,appear:this.isMounted,onAfterEnter:this.onAfterEnter,onAfterLeave:this.handleAfterLeave},{default:()=>U(m("div",ue(this.$attrs,{role:"dialog",ref:"bodyRef","aria-modal":"true",class:[`${t}-drawer`,this.rtlEnabled&&`${t}-drawer--rtl`,`${t}-drawer--${this.placement}-placement`,this.isDragging&&`${t}-drawer--unselectable`,this.nativeScrollbar&&`${t}-drawer--native-scrollbar`]}),[this.resizable?m("div",{class:[`${t}-drawer__resize-trigger`,(this.isDragging||this.isHoverOnResizeTrigger)&&`${t}-drawer__resize-trigger--hover`],onMouseenter:this.handleMouseenterResizeTrigger,onMouseleave:this.handleMouseleaveResizeTrigger,onMousedown:this.handleMousedownResizeTrigger}):null,this.nativeScrollbar?m("div",{class:[`${t}-drawer-content-wrapper`,this.contentClass],style:this.contentStyle,role:"none"},e):m(Re,Object.assign({},this.scrollbarProps,{contentStyle:this.contentStyle,contentClass:[`${t}-drawer-content-wrapper`,this.contentClass],theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar}),e)]),this.bodyDirectives)})})),[[Z,this.displayDirective==="if"||this.displayed||this.show]]):null}}),{cubicBezierEaseIn:Mt,cubicBezierEaseOut:Ft}=te;function At({duration:e="0.3s",leaveDuration:t="0.2s",name:r="slide-in-from-bottom"}={}){return[g(`&.${r}-transition-leave-active`,{transition:`transform ${t} ${Mt}`}),g(`&.${r}-transition-enter-active`,{transition:`transform ${e} ${Ft}`}),g(`&.${r}-transition-enter-to`,{transform:"translateY(0)"}),g(`&.${r}-transition-enter-from`,{transform:"translateY(100%)"}),g(`&.${r}-transition-leave-from`,{transform:"translateY(0)"}),g(`&.${r}-transition-leave-to`,{transform:"translateY(100%)"})]}const{cubicBezierEaseIn:Pt,cubicBezierEaseOut:Ht}=te;function Ut({duration:e="0.3s",leaveDuration:t="0.2s",name:r="slide-in-from-left"}={}){return[g(`&.${r}-transition-leave-active`,{transition:`transform ${t} ${Pt}`}),g(`&.${r}-transition-enter-active`,{transition:`transform ${e} ${Ht}`}),g(`&.${r}-transition-enter-to`,{transform:"translateX(0)"}),g(`&.${r}-transition-enter-from`,{transform:"translateX(-100%)"}),g(`&.${r}-transition-leave-from`,{transform:"translateX(0)"}),g(`&.${r}-transition-leave-to`,{transform:"translateX(-100%)"})]}const{cubicBezierEaseIn:jt,cubicBezierEaseOut:Lt}=te;function Gt({duration:e="0.3s",leaveDuration:t="0.2s",name:r="slide-in-from-right"}={}){return[g(`&.${r}-transition-leave-active`,{transition:`transform ${t} ${jt}`}),g(`&.${r}-transition-enter-active`,{transition:`transform ${e} ${Lt}`}),g(`&.${r}-transition-enter-to`,{transform:"translateX(0)"}),g(`&.${r}-transition-enter-from`,{transform:"translateX(100%)"}),g(`&.${r}-transition-leave-from`,{transform:"translateX(0)"}),g(`&.${r}-transition-leave-to`,{transform:"translateX(100%)"})]}const{cubicBezierEaseIn:Wt,cubicBezierEaseOut:qt}=te;function Xt({duration:e="0.3s",leaveDuration:t="0.2s",name:r="slide-in-from-top"}={}){return[g(`&.${r}-transition-leave-active`,{transition:`transform ${t} ${Wt}`}),g(`&.${r}-transition-enter-active`,{transition:`transform ${e} ${qt}`}),g(`&.${r}-transition-enter-to`,{transform:"translateY(0)"}),g(`&.${r}-transition-enter-from`,{transform:"translateY(-100%)"}),g(`&.${r}-transition-leave-from`,{transform:"translateY(0)"}),g(`&.${r}-transition-leave-to`,{transform:"translateY(-100%)"})]}const Vt=g([F("drawer",`
 word-break: break-word;
 line-height: var(--n-line-height);
 position: absolute;
 pointer-events: all;
 box-shadow: var(--n-box-shadow);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 background-color: var(--n-color);
 color: var(--n-text-color);
 box-sizing: border-box;
 `,[Gt(),Ut(),Xt(),At(),A("unselectable",`
 user-select: none; 
 -webkit-user-select: none;
 `),A("native-scrollbar",[F("drawer-content-wrapper",`
 overflow: auto;
 height: 100%;
 `)]),L("resize-trigger",`
 position: absolute;
 background-color: #0000;
 transition: background-color .3s var(--n-bezier);
 `,[A("hover",`
 background-color: var(--n-resize-trigger-color-hover);
 `)]),F("drawer-content-wrapper",`
 box-sizing: border-box;
 `),F("drawer-content",`
 height: 100%;
 display: flex;
 flex-direction: column;
 `,[A("native-scrollbar",[F("drawer-body-content-wrapper",`
 height: 100%;
 overflow: auto;
 `)]),F("drawer-body",`
 flex: 1 0 0;
 overflow: hidden;
 `),F("drawer-body-content-wrapper",`
 box-sizing: border-box;
 padding: var(--n-body-padding);
 `),F("drawer-header",`
 font-weight: var(--n-title-font-weight);
 line-height: 1;
 font-size: var(--n-title-font-size);
 color: var(--n-title-text-color);
 padding: var(--n-header-padding);
 transition: border .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-divider-color);
 border-bottom: var(--n-header-border-bottom);
 display: flex;
 justify-content: space-between;
 align-items: center;
 `,[L("main",`
 flex: 1;
 `),L("close",`
 margin-left: 6px;
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `)]),F("drawer-footer",`
 display: flex;
 justify-content: flex-end;
 border-top: var(--n-footer-border-top);
 transition: border .3s var(--n-bezier);
 padding: var(--n-footer-padding);
 `)]),A("right-placement",`
 top: 0;
 bottom: 0;
 right: 0;
 border-top-left-radius: var(--n-border-radius);
 border-bottom-left-radius: var(--n-border-radius);
 `,[L("resize-trigger",`
 width: 3px;
 height: 100%;
 top: 0;
 left: 0;
 transform: translateX(-1.5px);
 cursor: ew-resize;
 `)]),A("left-placement",`
 top: 0;
 bottom: 0;
 left: 0;
 border-top-right-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[L("resize-trigger",`
 width: 3px;
 height: 100%;
 top: 0;
 right: 0;
 transform: translateX(1.5px);
 cursor: ew-resize;
 `)]),A("top-placement",`
 top: 0;
 left: 0;
 right: 0;
 border-bottom-left-radius: var(--n-border-radius);
 border-bottom-right-radius: var(--n-border-radius);
 `,[L("resize-trigger",`
 width: 100%;
 height: 3px;
 bottom: 0;
 left: 0;
 transform: translateY(1.5px);
 cursor: ns-resize;
 `)]),A("bottom-placement",`
 left: 0;
 bottom: 0;
 right: 0;
 border-top-left-radius: var(--n-border-radius);
 border-top-right-radius: var(--n-border-radius);
 `,[L("resize-trigger",`
 width: 100%;
 height: 3px;
 top: 0;
 left: 0;
 transform: translateY(-1.5px);
 cursor: ns-resize;
 `)])]),g("body",[g(">",[F("drawer-container",`
 position: fixed;
 `)])]),F("drawer-container",`
 position: relative;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 `,[g("> *",`
 pointer-events: all;
 `)]),F("drawer-mask",`
 background-color: rgba(0, 0, 0, .3);
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `,[A("invisible",`
 background-color: rgba(0, 0, 0, 0)
 `),Ze({enterDuration:"0.2s",leaveDuration:"0.2s",enterCubicBezier:"var(--n-bezier-in)",leaveCubicBezier:"var(--n-bezier-out)"})])]),Yt=Object.assign(Object.assign({},xe.props),{show:Boolean,width:[Number,String],height:[Number,String],placement:{type:String,default:"right"},maskClosable:{type:Boolean,default:!0},showMask:{type:[Boolean,String],default:!0},to:[String,Object],displayDirective:{type:String,default:"if"},nativeScrollbar:{type:Boolean,default:!0},zIndex:Number,onMaskClick:Function,scrollbarProps:Object,contentClass:String,contentStyle:[Object,String],trapFocus:{type:Boolean,default:!0},onEsc:Function,autoFocus:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,defaultWidth:{type:[Number,String],default:251},defaultHeight:{type:[Number,String],default:251},onUpdateWidth:[Function,Array],onUpdateHeight:[Function,Array],"onUpdate:width":[Function,Array],"onUpdate:height":[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,drawerStyle:[String,Object],drawerClass:String,target:null,onShow:Function,onHide:Function}),Kt=K({name:"Drawer",inheritAttrs:!1,props:Yt,setup(e){const{mergedClsPrefixRef:t,namespaceRef:r,inlineThemeDisabled:i}=he(e),a=et(),u=xe("Drawer","-drawer",Vt,tt,e,t),s=R(e.defaultWidth),c=R(e.defaultHeight),f=pe(ee(e,"width"),s),v=pe(ee(e,"height"),c),M=D(()=>{const{placement:l}=e;return l==="top"||l==="bottom"?"":me(f.value)}),O=D(()=>{const{placement:l}=e;return l==="left"||l==="right"?"":me(v.value)}),x=l=>{const{onUpdateWidth:w,"onUpdate:width":k}=e;w&&G(w,l),k&&G(k,l),s.value=l},E=l=>{const{onUpdateHeight:w,"onUpdate:width":k}=e;w&&G(w,l),k&&G(k,l),c.value=l},S=D(()=>[{width:M.value,height:O.value},e.drawerStyle||""]);function z(l){const{onMaskClick:w,maskClosable:k}=e;k&&I(!1),w&&w(l)}function T(l){z(l)}const y=rt();function h(l){var w;(w=e.onEsc)===null||w===void 0||w.call(e),e.show&&e.closeOnEsc&&it(l)&&(y.value||I(!1))}function I(l){const{onHide:w,onUpdateShow:k,"onUpdate:show":n}=e;k&&G(k,l),n&&G(n,l),w&&!l&&G(w,l)}Y(fe,{isMountedRef:a,mergedThemeRef:u,mergedClsPrefixRef:t,doUpdateShow:I,doUpdateHeight:E,doUpdateWidth:x});const N=D(()=>{const{common:{cubicBezierEaseInOut:l,cubicBezierEaseIn:w,cubicBezierEaseOut:k},self:{color:n,textColor:o,boxShadow:d,lineHeight:b,headerPadding:B,footerPadding:H,borderRadius:j,bodyPadding:re,titleFontSize:oe,titleTextColor:Ee,titleFontWeight:Ne,headerBorderBottom:Te,footerBorderTop:De,closeIconColor:Oe,closeIconColorHover:Ie,closeIconColorPressed:Me,closeColorHover:Fe,closeColorPressed:Ae,closeIconSize:Pe,closeSize:He,closeBorderRadius:Ue,resizableTriggerColorHover:je}}=u.value;return{"--n-line-height":b,"--n-color":n,"--n-border-radius":j,"--n-text-color":o,"--n-box-shadow":d,"--n-bezier":l,"--n-bezier-out":k,"--n-bezier-in":w,"--n-header-padding":B,"--n-body-padding":re,"--n-footer-padding":H,"--n-title-text-color":Ee,"--n-title-font-size":oe,"--n-title-font-weight":Ne,"--n-header-border-bottom":Te,"--n-footer-border-top":De,"--n-close-icon-color":Oe,"--n-close-icon-color-hover":Ie,"--n-close-icon-color-pressed":Me,"--n-close-size":He,"--n-close-color-hover":Fe,"--n-close-color-pressed":Ae,"--n-close-icon-size":Pe,"--n-close-border-radius":Ue,"--n-resize-trigger-color-hover":je}}),$=i?ot("drawer",void 0,N,e):void 0;return{mergedClsPrefix:t,namespace:r,mergedBodyStyle:S,handleOutsideClick:T,handleMaskClick:z,handleEsc:h,mergedTheme:u,cssVars:i?void 0:N,themeClass:$==null?void 0:$.themeClass,onRender:$==null?void 0:$.onRender,isMounted:a}},render(){const{mergedClsPrefix:e}=this;return m(at,{to:this.to,show:this.show},{default:()=>{var t;return(t=this.onRender)===null||t===void 0||t.call(this),U(m("div",{class:[`${e}-drawer-container`,this.namespace,this.themeClass],style:this.cssVars,role:"none"},this.showMask?m(Ce,{name:"fade-in-transition",appear:this.isMounted},{default:()=>this.show?m("div",{"aria-hidden":!0,class:[`${e}-drawer-mask`,this.showMask==="transparent"&&`${e}-drawer-mask--invisible`],onClick:this.handleMaskClick}):null}):null,m(It,Object.assign({},this.$attrs,{class:[this.drawerClass,this.$attrs.class],style:[this.mergedBodyStyle,this.$attrs.style],blockScroll:this.blockScroll,contentStyle:this.contentStyle,contentClass:this.contentClass,placement:this.placement,scrollbarProps:this.scrollbarProps,show:this.show,displayDirective:this.displayDirective,nativeScrollbar:this.nativeScrollbar,onAfterEnter:this.onAfterEnter,onAfterLeave:this.onAfterLeave,trapFocus:this.trapFocus,autoFocus:this.autoFocus,resizable:this.resizable,maxHeight:this.maxHeight,minHeight:this.minHeight,maxWidth:this.maxWidth,minWidth:this.minWidth,showMask:this.showMask,onEsc:this.handleEsc,onClickoutside:this.handleOutsideClick}),this.$slots)),[[nt,{zIndex:this.zIndex,enabled:this.show}]])}})}}),Qt={title:String,headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],bodyClass:String,bodyStyle:[Object,String],bodyContentClass:String,bodyContentStyle:[Object,String],nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,closable:Boolean},Jt=K({name:"DrawerContent",props:Qt,slots:Object,setup(){const e=ce(fe,null);e||st("drawer-content","`n-drawer-content` must be placed inside `n-drawer`.");const{doUpdateShow:t}=e;function r(){t(!1)}return{handleCloseClick:r,mergedTheme:e.mergedThemeRef,mergedClsPrefix:e.mergedClsPrefixRef}},render(){const{title:e,mergedClsPrefix:t,nativeScrollbar:r,mergedTheme:i,bodyClass:a,bodyStyle:u,bodyContentClass:s,bodyContentStyle:c,headerClass:f,headerStyle:v,footerClass:M,footerStyle:O,scrollbarProps:x,closable:E,$slots:S}=this;return m("div",{role:"none",class:[`${t}-drawer-content`,r&&`${t}-drawer-content--native-scrollbar`]},S.header||e||E?m("div",{class:[`${t}-drawer-header`,f],style:v,role:"none"},m("div",{class:`${t}-drawer-header__main`,role:"heading","aria-level":"1"},S.header!==void 0?S.header():e),E&&m(lt,{onClick:this.handleCloseClick,clsPrefix:t,class:`${t}-drawer-header__close`,absolute:!0})):null,r?m("div",{class:[`${t}-drawer-body`,a],style:u,role:"none"},m("div",{class:[`${t}-drawer-body-content-wrapper`,s],style:c,role:"none"},S)):m(Re,Object.assign({themeOverrides:i.peerOverrides.Scrollbar,theme:i.peers.Scrollbar},x,{class:`${t}-drawer-body`,contentClass:[`${t}-drawer-body-content-wrapper`,s],contentStyle:c}),S),S.footer?m("div",{class:[`${t}-drawer-footer`,M],style:O,role:"none"},S.footer()):null)}}),we=1,ke=dt("n-grid"),_e=1,Zt={span:{type:[Number,String],default:_e},offset:{type:[Number,String],default:0},suffix:Boolean,privateOffset:Number,privateSpan:Number,privateColStart:Number,privateShow:{type:Boolean,default:!0}},Se=K({__GRID_ITEM__:!0,name:"GridItem",alias:["Gi"],props:Zt,setup(){const{isSsrRef:e,xGapRef:t,itemStyleRef:r,overflowRef:i,layoutShiftDisabledRef:a}=ce(ke),u=ut();return{overflow:i,itemStyle:r,layoutShiftDisabled:a,mergedXGap:D(()=>q(t.value||0)),deriveStyle:()=>{e.value;const{privateSpan:s=_e,privateShow:c=!0,privateColStart:f=void 0,privateOffset:v=0}=u.vnode.props,{value:M}=t,O=q(M||0);return{display:c?"":"none",gridColumn:`${f!=null?f:`span ${s}`} / span ${s}`,marginLeft:v?`calc((100% - (${s} - 1) * ${O}) / ${s} * ${v} + ${O} * ${v})`:""}}}},render(){var e,t;if(this.layoutShiftDisabled){const{span:r,offset:i,mergedXGap:a}=this;return m("div",{style:{gridColumn:`span ${r} / span ${r}`,marginLeft:i?`calc((100% - (${r} - 1) * ${a}) / ${r} * ${i} + ${a} * ${i})`:""}},this.$slots)}return m("div",{style:[this.itemStyle,this.deriveStyle()]},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e,{overflow:this.overflow}))}}),er={xs:0,s:640,m:1024,l:1280,xl:1536,xxl:1920},Be=24,de="__ssr__",tr={layoutShiftDisabled:Boolean,responsive:{type:[String,Boolean],default:"self"},cols:{type:[Number,String],default:Be},itemResponsive:Boolean,collapsed:Boolean,collapsedRows:{type:Number,default:1},itemStyle:[Object,String],xGap:{type:[Number,String],default:0},yGap:{type:[Number,String],default:0}},rr=K({name:"Grid",inheritAttrs:!1,props:tr,setup(e){const{mergedClsPrefixRef:t,mergedBreakpointsRef:r}=he(e),i=/^\d+$/,a=R(void 0),u=Dt((r==null?void 0:r.value)||er),s=Q(()=>!!(e.itemResponsive||!i.test(e.cols.toString())||!i.test(e.xGap.toString())||!i.test(e.yGap.toString()))),c=D(()=>{if(s.value)return e.responsive==="self"?a.value:u.value}),f=Q(()=>{var y;return(y=Number(W(e.cols.toString(),c.value)))!==null&&y!==void 0?y:Be}),v=Q(()=>W(e.xGap.toString(),c.value)),M=Q(()=>W(e.yGap.toString(),c.value)),O=y=>{a.value=y.contentRect.width},x=y=>{ht(O,y)},E=R(!1),S=D(()=>{if(e.responsive==="self")return x}),z=R(!1),T=R();return ze(()=>{const{value:y}=T;y&&y.hasAttribute(de)&&(y.removeAttribute(de),z.value=!0)}),Y(ke,{layoutShiftDisabledRef:ee(e,"layoutShiftDisabled"),isSsrRef:z,itemStyleRef:ee(e,"itemStyle"),xGapRef:v,overflowRef:E}),{isSsr:!ct,contentEl:T,mergedClsPrefix:t,style:D(()=>e.layoutShiftDisabled?{width:"100%",display:"grid",gridTemplateColumns:`repeat(${e.cols}, minmax(0, 1fr))`,columnGap:q(e.xGap),rowGap:q(e.yGap)}:{width:"100%",display:"grid",gridTemplateColumns:`repeat(${f.value}, minmax(0, 1fr))`,columnGap:q(v.value),rowGap:q(M.value)}),isResponsive:s,responsiveQuery:c,responsiveCols:f,handleResize:S,overflow:E}},render(){if(this.layoutShiftDisabled)return m("div",ue({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style},this.$attrs),this.$slots);const e=()=>{var t,r,i,a,u,s,c;this.overflow=!1;const f=pt(xt(this)),v=[],{collapsed:M,collapsedRows:O,responsiveCols:x,responsiveQuery:E}=this;f.forEach(h=>{var I,N,$,l,w;if(((I=h==null?void 0:h.type)===null||I===void 0?void 0:I.__GRID_ITEM__)!==!0)return;if(Ot(h)){const o=ve(h);o.props?o.props.privateShow=!1:o.props={privateShow:!1},v.push({child:o,rawChildSpan:0});return}h.dirs=((N=h.dirs)===null||N===void 0?void 0:N.filter(({dir:o})=>o!==Z))||null,(($=h.dirs)===null||$===void 0?void 0:$.length)===0&&(h.dirs=null);const k=ve(h),n=Number((w=W((l=k.props)===null||l===void 0?void 0:l.span,E))!==null&&w!==void 0?w:we);n!==0&&v.push({child:k,rawChildSpan:n})});let S=0;const z=(t=v[v.length-1])===null||t===void 0?void 0:t.child;if(z!=null&&z.props){const h=(r=z.props)===null||r===void 0?void 0:r.suffix;h!==void 0&&h!==!1&&(S=Number((a=W((i=z.props)===null||i===void 0?void 0:i.span,E))!==null&&a!==void 0?a:we),z.props.privateSpan=S,z.props.privateColStart=x+1-S,z.props.privateShow=(u=z.props.privateShow)!==null&&u!==void 0?u:!0)}let T=0,y=!1;for(const{child:h,rawChildSpan:I}of v){if(y&&(this.overflow=!0),!y){const N=Number((c=W((s=h.props)===null||s===void 0?void 0:s.offset,E))!==null&&c!==void 0?c:0),$=Math.min(I+N,x);if(h.props?(h.props.privateSpan=$,h.props.privateOffset=N):h.props={privateSpan:$,privateOffset:N},M){const l=T%x;$+l>x&&(T+=x-l),$+T+S>O*x?y=!0:T+=$}}y&&(h.props?h.props.privateShow!==!0&&(h.props.privateShow=!1):h.props={privateShow:!1})}return m("div",ue({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style,[de]:this.isSsr||void 0},this.$attrs),v.map(({child:h})=>h))};return this.isResponsive&&this.responsive==="self"?m(ft,{onResize:this.handleResize},{default:e}):e()}}),mr=Object.assign({name:"角色管理"},{__name:"index",setup(e){const t=R(null),r=R({}),i=mt("permission"),{modalVisible:a,modalAction:u,modalTitle:s,modalLoading:c,handleAdd:f,handleDelete:v,handleEdit:M,handleSave:O,modalForm:x,modalFormRef:E}=$t({name:"角色",initForm:{},doCreate:P.createRole,doDelete:P.deleteRole,doUpdate:P.updateRole,refresh:()=>{var n;return(n=t.value)==null?void 0:n.handleSearch()}}),S=R(""),z=R([]),T=R(!1),y=R([]),h=R(0),I=R([]),N=R([]),$=R([]);function l(n){const o=[],d={};return n.forEach(b=>{const B=b.tags,j=b.path.split("/").slice(0,-1).join("/"),re=B.charAt(0).toUpperCase()+B.slice(1),oe=b.method.toLowerCase()+b.path;j in d||(d[j]={unique_id:j,path:j,summary:re,children:[]}),d[j].children.push({id:b.id,path:b.path,method:b.method,summary:b.summary,unique_id:oe})}),o.push(...Object.values(d)),o}ze(()=>{var n;(n=t.value)==null||n.handleSearch()});const w=[{title:"角色名",key:"name",width:80,align:"center",ellipsis:{tooltip:!0},render(n){return m(gt,{type:"info"},{default:()=>n.name})}},{title:"角色描述",key:"desc",width:80,align:"center"},{title:"创建日期",key:"created_at",width:60,align:"center",render(n){return m("span",yt(n.created_at))}},{title:"操作",key:"actions",width:80,align:"center",fixed:"right",render(n){return[U(m(X,{size:"small",type:"primary",style:"margin-right: 8px;",onClick:()=>{M(n)}},{default:()=>"编辑",icon:le("material-symbols:edit-outline",{size:16})}),[[i,"post/api/v1/role/update"]]),m(Rt,{onPositiveClick:()=>v({role_id:n.id},!1),onNegativeClick:()=>{}},{trigger:()=>U(m(X,{size:"small",type:"error",style:"margin-right: 8px;"},{default:()=>"删除",icon:le("material-symbols:delete-outline",{size:16})}),[[i,"delete/api/v1/role/delete"]]),default:()=>m("div",{},"确定删除该角色吗?")}),U(m(X,{size:"small",type:"primary",onClick:()=>ne(this,null,function*(){try{const[o,d,b]=yield Promise.all([P.getMenus({page:1,page_size:9999}),P.getApis({page:1,page_size:9999}),P.getRoleAuthorized({id:n.id})]);z.value=o.data,I.value=l(d.data),y.value=b.data.menus.map(B=>B.id),N.value=b.data.apis.map(B=>B.method.toLowerCase()+B.path),T.value=!0,h.value=n.id}catch(o){console.error("Error loading data:",o)}})},{default:()=>"设置权限",icon:le("material-symbols:edit-outline",{size:16})}),[[i,"get/api/v1/role/authorized"]])]}}];function k(){return ne(this,null,function*(){const n=$.value.getCheckedData(),o=[];n&&n.options.forEach(H=>{H.children||o.push({path:H.path,method:H.method})});const{code:d,msg:b}=yield P.updateRoleAuthorized({id:h.value,menu_ids:y.value,api_infos:o});d===200?$message==null||$message.success("设置成功"):$message==null||$message.error(b);const B=yield P.getRoleAuthorized({id:h.value});y.value=B.data.menus.map(H=>H.id)})}return(n,o)=>(ae(),ie(wt,{"show-footer":"",title:"角色列表"},{action:_(()=>[U((ae(),ie(p(X),{type:"primary",onClick:p(f)},{default:_(()=>[C(zt,{icon:"material-symbols:add",size:18,class:"mr-5"}),o[10]||(o[10]=se("新建角色 ",-1))]),_:1},8,["onClick"])),[[p(i),"post/api/v1/role/create"]])]),default:_(()=>[C(kt,{ref_key:"$table",ref:t,"query-items":r.value,"onUpdate:queryItems":o[2]||(o[2]=d=>r.value=d),columns:w,"get-data":p(P).getRoleList},{queryBar:_(()=>[C(St,{label:"角色名","label-width":50},{default:_(()=>[C(p(J),{value:r.value.role_name,"onUpdate:value":o[0]||(o[0]=d=>r.value.role_name=d),clearable:"",type:"text",placeholder:"请输入角色名",onKeypress:o[1]||(o[1]=vt(d=>{var b;return(b=t.value)==null?void 0:b.handleSearch()},["enter"]))},null,8,["value"])]),_:1})]),_:1},8,["query-items","get-data"]),C(Ct,{visible:p(a),"onUpdate:visible":o[5]||(o[5]=d=>bt(a)?a.value=d:null),title:p(s),loading:p(c),onSave:p(O)},{default:_(()=>[C(p(_t),{ref_key:"modalFormRef",ref:E,"label-placement":"left","label-align":"left","label-width":80,model:p(x),disabled:p(u)==="view"},{default:_(()=>[C(p(ge),{label:"角色名",path:"name",rule:{required:!0,message:"请输入角色名称",trigger:["input","blur"]}},{default:_(()=>[C(p(J),{value:p(x).name,"onUpdate:value":o[3]||(o[3]=d=>p(x).name=d),placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),C(p(ge),{label:"角色描述",path:"desc"},{default:_(()=>[C(p(J),{value:p(x).desc,"onUpdate:value":o[4]||(o[4]=d=>p(x).desc=d),placeholder:"请输入角色描述"},null,8,["value"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["visible","title","loading","onSave"]),C(p(Kt),{show:T.value,"onUpdate:show":o[9]||(o[9]=d=>T.value=d),placement:"right",width:500},{default:_(()=>[C(p(Jt),null,{header:_(()=>[...o[12]||(o[12]=[se(" 设置权限 ",-1)])]),default:_(()=>[C(p(rr),{"x-gap":"24",cols:"12"},{default:_(()=>[C(p(Se),{span:"8"},{default:_(()=>[C(p(J),{value:S.value,"onUpdate:value":o[6]||(o[6]=d=>S.value=d),type:"text",placeholder:"筛选",style:{"flex-grow":"1"}},null,8,["value"])]),_:1}),C(p(Se),{offset:"2"},{default:_(()=>[U((ae(),ie(p(X),{type:"info",onClick:k},{default:_(()=>[...o[11]||(o[11]=[se("确定",-1)])]),_:1})),[[p(i),"post/api/v1/role/authorized"]])]),_:1})]),_:1}),C(p(Bt),null,{default:_(()=>[C(p(ye),{name:"menu",tab:"菜单权限","display-directive":"show"},{default:_(()=>[C(p(be),{data:z.value,"checked-keys":y.value,pattern:S.value,"show-irrelevant-nodes":!1,"key-field":"id","label-field":"name",checkable:"","default-expand-all":!0,"block-line":!0,selectable:!1,"onUpdate:checkedKeys":o[7]||(o[7]=d=>y.value=d)},null,8,["data","checked-keys","pattern"])]),_:1}),C(p(ye),{name:"resource",tab:"接口权限","display-directive":"show"},{default:_(()=>[C(p(be),{ref_key:"apiTree",ref:$,data:I.value,"checked-keys":N.value,pattern:S.value,"show-irrelevant-nodes":!1,"key-field":"unique_id","label-field":"summary",checkable:"","default-expand-all":!0,"block-line":!0,selectable:!1,cascade:"","onUpdate:checkedKeys":o[8]||(o[8]=d=>N.value=d)},null,8,["data","checked-keys","pattern"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])]),_:1}))}});export{mr as default};
