var H=Object.defineProperty;var k=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var S=(e,t,o)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,P=(e,t)=>{for(var o in t||(t={}))G.call(t,o)&&S(e,o,t[o]);if(k)for(var o of k(t))J.call(t,o)&&S(e,o,t[o]);return e};var x=(e,t,o)=>new Promise((l,c)=>{var r=i=>{try{n(o.next(i))}catch(a){c(a)}},s=i=>{try{n(o.throw(i))}catch(a){c(a)}},n=i=>i.done?l(i.value):Promise.resolve(i.value).then(r,s);n((o=o.apply(e,t)).next())});import{n as Q,g as F,z as U,G as Y,c as C,H as Z,B as N,Z as B,h as v,$ as T,aA as X,N as ee,aa as te,bR as oe,q as _,a5 as w,p as z,m as E,bS as ne,A as g,Y as ie,bT as se,bp as ae,aQ as le,bU as re,P as j,o as ce,b as ue,bV as de,w as b,d as ve,bK as O,e as R,a0 as $,f as pe,aj as fe,R as me,bW as ge,bJ as he}from"./index-96e58cca.js";import{u as I}from"./Input-22abf345.js";const A=Q("n-popconfirm"),q={positiveText:String,negativeText:String,showIcon:{type:Boolean,default:!0},onPositiveClick:{type:Function,required:!0},onNegativeClick:{type:Function,required:!0}},V=oe(q),Pe=F({name:"NPopconfirmPanel",props:q,setup(e){const{localeRef:t}=I("Popconfirm"),{inlineThemeDisabled:o}=U(),{mergedClsPrefixRef:l,mergedThemeRef:c,props:r}=Y(A),s=C(()=>{const{common:{cubicBezierEaseInOut:i},self:{fontSize:a,iconSize:d,iconColor:u}}=c.value;return{"--n-bezier":i,"--n-font-size":a,"--n-icon-size":d,"--n-icon-color":u}}),n=o?Z("popconfirm-panel",void 0,s,r):void 0;return Object.assign(Object.assign({},I("Popconfirm")),{mergedClsPrefix:l,cssVars:o?void 0:s,localizedPositiveText:C(()=>e.positiveText||t.value.positiveText),localizedNegativeText:C(()=>e.negativeText||t.value.negativeText),positiveButtonProps:N(r,"positiveButtonProps"),negativeButtonProps:N(r,"negativeButtonProps"),handlePositiveClick(i){e.onPositiveClick(i)},handleNegativeClick(i){e.onNegativeClick(i)},themeClass:n==null?void 0:n.themeClass,onRender:n==null?void 0:n.onRender})},render(){var e;const{mergedClsPrefix:t,showIcon:o,$slots:l}=this,c=B(l.action,()=>this.negativeText===null&&this.positiveText===null?[]:[this.negativeText!==null&&v(T,Object.assign({size:"small",onClick:this.handleNegativeClick},this.negativeButtonProps),{default:()=>this.localizedNegativeText}),this.positiveText!==null&&v(T,Object.assign({size:"small",type:"primary",onClick:this.handlePositiveClick},this.positiveButtonProps),{default:()=>this.localizedPositiveText})]);return(e=this.onRender)===null||e===void 0||e.call(this),v("div",{class:[`${t}-popconfirm__panel`,this.themeClass],style:this.cssVars},X(l.default,r=>o||r?v("div",{class:`${t}-popconfirm__body`},o?v("div",{class:`${t}-popconfirm__icon`},B(l.icon,()=>[v(ee,{clsPrefix:t},{default:()=>v(te,null)})])):null,r):null),c?v("div",{class:[`${t}-popconfirm__action`]},c):null)}}),Ce=_("popconfirm",[w("body",`
 font-size: var(--n-font-size);
 display: flex;
 align-items: center;
 flex-wrap: nowrap;
 position: relative;
 `,[w("icon",`
 display: flex;
 font-size: var(--n-icon-size);
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 margin: 0 8px 0 0;
 `)]),w("action",`
 display: flex;
 justify-content: flex-end;
 `,[z("&:not(:first-child)","margin-top: 8px"),_("button",[z("&:not(:last-child)","margin-right: 8px;")])])]),be=Object.assign(Object.assign(Object.assign({},E.props),re),{positiveText:String,negativeText:String,showIcon:{type:Boolean,default:!0},trigger:{type:String,default:"click"},positiveButtonProps:Object,negativeButtonProps:Object,onPositiveClick:Function,onNegativeClick:Function}),Ne=F({name:"Popconfirm",props:be,slots:Object,__popover__:!0,setup(e){const{mergedClsPrefixRef:t}=U(),o=E("Popconfirm","-popconfirm",Ce,ne,e,t),l=g(null);function c(n){var i;if(!(!((i=l.value)===null||i===void 0)&&i.getMergedShow()))return;const{onPositiveClick:a,"onUpdate:show":d}=e;Promise.resolve(a?a(n):!0).then(u=>{var p;u!==!1&&((p=l.value)===null||p===void 0||p.setShow(!1),d&&j(d,!1))})}function r(n){var i;if(!(!((i=l.value)===null||i===void 0)&&i.getMergedShow()))return;const{onNegativeClick:a,"onUpdate:show":d}=e;Promise.resolve(a?a(n):!0).then(u=>{var p;u!==!1&&((p=l.value)===null||p===void 0||p.setShow(!1),d&&j(d,!1))})}return ie(A,{mergedThemeRef:o,mergedClsPrefixRef:t,props:e}),{setShow(n){var i;(i=l.value)===null||i===void 0||i.setShow(n)},syncPosition(){var n;(n=l.value)===null||n===void 0||n.syncPosition()},mergedTheme:o,popoverInstRef:l,handlePositiveClick:c,handleNegativeClick:r}},render(){const{$slots:e,$props:t,mergedTheme:o}=this;return v(le,Object.assign({},ae(t,V),{theme:o.peers.Popover,themeOverrides:o.peerOverrides.Popover,internalExtraClass:["popconfirm"],ref:"popoverInstRef"}),{trigger:e.trigger,default:()=>{const l=se(t,V);return v(Pe,Object.assign({},l,{onPositiveClick:this.handlePositiveClick,onNegativeClick:this.handleNegativeClick}),e)}})}}),ye={flex:"","justify-end":""},Be={__name:"CrudModal",props:{width:{type:String,default:"600px"},title:{type:String,default:""},showFooter:{type:Boolean,default:!0},visible:{type:Boolean,required:!0},loading:{type:Boolean,default:!1}},emits:["update:visible","onSave"],setup(e,{emit:t}){const o=e,l=t,c=C({get(){return o.visible},set(r){l("update:visible",r)}});return(r,s)=>{const n=T,i=ge;return ce(),ue(i,{show:pe(c),"onUpdate:show":s[2]||(s[2]=a=>fe(c)?c.value=a:null),style:me({width:e.width}),preset:"card",title:e.title,size:"huge",bordered:!1,"mask-closable":!1},de({default:b(()=>[O(r.$slots,"default")]),_:2},[e.showFooter?{name:"footer",fn:b(()=>[ve("footer",ye,[O(r.$slots,"footer",{},()=>[R(n,{onClick:s[0]||(s[0]=a=>c.value=!1)},{default:b(()=>[...s[3]||(s[3]=[$("取消",-1)])]),_:1}),R(n,{loading:e.loading,"ml-20":"",type:"primary",onClick:s[1]||(s[1]=a=>l("save"))},{default:b(()=>[...s[4]||(s[4]=[$("保存",-1)])]),_:1},8,["loading"])])])]),key:"0"}:void 0]),1032,["show","style","title"])}}},xe={view:"查看",edit:"编辑",add:"新增"};function _e({name:e,initForm:t={},doCreate:o,doDelete:l,doUpdate:c,refresh:r}){const s=g(!1),n=g(""),i=C(()=>xe[n.value]+e),a=g(!1),d=g(null),u=g(P({},t));function p(){n.value="add",s.value=!0,u.value=P({},t)}function K(f){n.value="edit",s.value=!0,u.value=P({},f)}function W(f){n.value="view",s.value=!0,u.value=P({},f)}function D(...f){var h;if(!["edit","add"].includes(n.value)){s.value=!1;return}(h=d.value)==null||h.validate(M=>x(this,null,function*(){if(M)return;const y={add:{api:()=>o(u.value),cb:()=>{f.forEach(m=>m&&m())},msg:()=>$message.success("新增成功")},edit:{api:()=>c(u.value),cb:()=>{f.forEach(m=>m&&m())},msg:()=>$message.success("编辑成功")}}[n.value];try{a.value=!0;const m=yield y.api();y.cb(),y.msg(),a.value=s.value=!1,m&&r(m)}catch(m){a.value=!1}}))}function L(){return x(this,arguments,function*(f={}){if(!he(f))try{a.value=!0;const h=yield l(f);$message.success("删除成功"),a.value=!1,r(h)}catch(h){a.value=!1}})}return{modalVisible:s,modalAction:n,modalTitle:i,modalLoading:a,handleAdd:p,handleDelete:L,handleEdit:K,handleView:W,handleSave:D,modalForm:u,modalFormRef:d}}export{Ne as N,Be as _,_e as u};
