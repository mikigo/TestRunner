var U=(z,h,s)=>new Promise((p,o)=>{var f=u=>{try{k(s.next(u))}catch(m){o(m)}},b=u=>{try{k(s.throw(u))}catch(m){o(m)}},k=u=>u.done?p(u.value):Promise.resolve(u.value).then(f,b);k((s=s.apply(z,h)).next())});import{_ as E}from"./CommonPage-77443609.js";import{u as J,_ as G,N as H}from"./useCRUD-0b0ca511.js";import{_ as N,a as W,e as Q,f as j}from"./TheIcon-9bd72e0e.js";import{A as _,aK as X,o as v,a2 as w,e as l,w as d,f as e,d as R,a0 as B,M as Y,aL as Z,aJ as ee,ai as ie,a1 as g,W as te,b as D,J as $,$ as q,aj as le,aM as ae,h as c,aN as ne,aO as oe,ak as S}from"./index-65c853c8.js";import{N as x}from"./Input-a2b3f6ce.js";import{N as C}from"./Switch-ed15716e.js";import{N as de,a as r}from"./FormItem-2018da53.js";import{N as ue}from"./TreeSelect-31ddc50f.js";import{N as me}from"./InputNumber-28ab8f0f.js";import"./AppPage-cad4d29a.js";import"./Tree-cba292bc.js";import"./Add-58195d29.js";const T=["mdi-air-humidifier-off","mdi-chili-off","mdi-cigar-off","mdi-clock-time-eight","mdi-clock-time-eight-outline","mdi-clock-time-eleven","mdi-clock-time-eleven-outline","mdi-clock-time-five","mdi-clock-time-five-outline","mdi-clock-time-four","mdi-clock-time-four-outline","mdi-clock-time-nine","mdi-clock-time-nine-outline","mdi-clock-time-one","mdi-clock-time-one-outline","mdi-clock-time-seven","mdi-clock-time-seven-outline","mdi-clock-time-six","mdi-clock-time-six-outline","mdi-clock-time-ten","mdi-clock-time-ten-outline","mdi-clock-time-three","mdi-clock-time-three-outline","mdi-clock-time-twelve","mdi-clock-time-twelve-outline","mdi-clock-time-two","mdi-clock-time-two-outline","mdi-cog-refresh","mdi-cog-refresh-outline","mdi-cog-sync","mdi-cog-sync-outline","mdi-content-save-cog","mdi-content-save-cog-outline","mdi-cosine-wave","mdi-cube-off","mdi-cube-off-outline","mdi-dome-light","mdi-download-box","mdi-download-box-outline","mdi-download-circle","mdi-download-circle-outline","mdi-fan-alert","mdi-fan-chevron-down","mdi-fan-chevron-up","mdi-fan-minus","mdi-fan-plus","mdi-fan-remove","mdi-fan-speed-1","mdi-fan-speed-2","mdi-fan-speed-3","mdi-food-drumstick","mdi-food-drumstick-off","mdi-food-drumstick-off-outline","mdi-food-drumstick-outline","mdi-food-steak","mdi-food-steak-off","mdi-fuse-alert","mdi-fuse-off","mdi-heart-minus","mdi-heart-minus-outline","mdi-heart-off-outline","mdi-heart-plus","mdi-heart-plus-outline","mdi-heart-remove","mdi-heart-remove-outline","mdi-hours-24","mdi-incognito-circle","mdi-incognito-circle-off","mdi-lingerie","mdi-microwave-off","mdi-minus-circle-off","mdi-minus-circle-off-outline","mdi-motion-sensor-off","mdi-pail-minus","mdi-pail-minus-outline","mdi-pail-off","mdi-pail-off-outline","mdi-pail-outline","mdi-pail-plus","mdi-pail-plus-outline","mdi-pail-remove","mdi-pail-remove-outline","mdi-pine-tree-fire","mdi-power-plug-off-outline","mdi-power-plug-outline","mdi-printer-eye","mdi-printer-search","mdi-puzzle-check","mdi-puzzle-check-outline","mdi-rug","mdi-sawtooth-wave","mdi-set-square","mdi-smoking-pipe-off","mdi-spoon-sugar","mdi-square-wave","mdi-table-split-cell","mdi-ticket-percent-outline","mdi-triangle-wave","mdi-waveform","mdi-wizard-hat","mdi-ab-testing","mdi-abjad-arabic","mdi-abjad-hebrew","mdi-abugida-devanagari","mdi-abugida-thai","mdi-access-point","mdi-access-point-network","mdi-access-point-network-off","mdi-account","mdi-account-alert","mdi-account-alert-outline","mdi-account-arrow-left","mdi-account-arrow-left-outline","mdi-account-arrow-right","mdi-account-arrow-right-outline","mdi-account-box","mdi-account-box-multiple","mdi-account-box-multiple-outline","mdi-account-box-outline","mdi-account-cancel","mdi-account-cancel-outline","mdi-account-cash","mdi-account-cash-outline","mdi-account-check","mdi-account-check-outline","mdi-account-child","mdi-account-child-circle","mdi-account-child-outline","mdi-account-circle","mdi-account-circle-outline","mdi-account-clock","mdi-account-clock-outline","mdi-account-cog","mdi-account-cog-outline","mdi-account-convert","mdi-account-convert-outline","mdi-account-cowboy-hat","mdi-account-details","mdi-account-details-outline","mdi-account-edit","mdi-account-edit-outline","mdi-account-group","mdi-account-group-outline","mdi-account-hard-hat","mdi-account-heart","mdi-account-heart-outline","mdi-account-key","mdi-account-key-outline","mdi-account-lock","mdi-account-lock-outline","mdi-account-minus","mdi-account-minus-outline","mdi-account-multiple","mdi-account-multiple-check","mdi-account-multiple-check-outline","mdi-account-multiple-minus","mdi-account-multiple-minus-outline","mdi-account-multiple-outline","mdi-account-multiple-plus","mdi-account-multiple-plus-outline","mdi-account-multiple-remove","mdi-account-multiple-remove-outline","mdi-account-music","mdi-account-music-outline","mdi-account-network","mdi-account-network-outline","mdi-account-off","mdi-account-off-outline","mdi-account-outline","mdi-account-plus","mdi-account-plus-outline","mdi-account-question","mdi-account-question-outline","mdi-account-remove","mdi-account-remove-outline","mdi-account-search","mdi-account-search-outline","mdi-account-settings","mdi-account-settings-outline","mdi-account-star","mdi-account-star-outline","mdi-account-supervisor","mdi-account-supervisor-circle","mdi-account-supervisor-outline","mdi-account-switch","mdi-account-switch-outline","mdi-account-tie","mdi-account-tie-outline","mdi-account-tie-voice","mdi-account-tie-voice-off","mdi-account-tie-voice-off-outline","mdi-account-tie-voice-outline","mdi-account-voice","mdi-adjust","mdi-adobe","mdi-adobe-acrobat","mdi-air-conditioner","mdi-air-filter","mdi-air-horn","mdi-air-humidifier","mdi-air-purifier","mdi-airbag","mdi-airballoon","mdi-airballoon-outline","mdi-airplane","mdi-airplane-landing","mdi-airplane-off","mdi-airplane-takeoff","mdi-airport","mdi-alarm","mdi-alarm-bell","mdi-alarm-check","mdi-alarm-light","mdi-alarm-light-outline","mdi-alarm-multiple","mdi-alarm-note","mdi-alarm-note-off","mdi-alarm-off","mdi-alarm-plus","mdi-alarm-snooze","mdi-album","mdi-alert","mdi-alert-box","mdi-alert-box-outline","mdi-alert-circle","mdi-alert-circle-check","mdi-alert-circle-check-outline","mdi-alert-circle-outline"],ce={class:"w-full"},re={key:0,class:"h-150 w-300 overflow-y-scroll"},se=["onClick"],pe={key:1},fe={__name:"IconPicker",props:{value:String},emits:["update:value"],setup(z,{emit:h}){const s=z,p=h,o=_(s.value),f=_(T);function b(){f.value=T.filter(u=>u.includes(o.value))}function k(u){o.value=u,p("update:value",o.value)}return X(o,()=>{b(),p("update:value",o.value)},{debounce:200}),(u,m)=>(v(),w("div",ce,[l(e(ee),{trigger:"click",placement:"bottom-start"},{trigger:d(()=>[l(e(x),{value:o.value,"onUpdate:value":[m[0]||(m[0]=y=>o.value=y),b],placeholder:"请输入图标名称"},{prefix:d(()=>[...m[1]||(m[1]=[R("span",{class:"i-mdi:magnify text-18"},null,-1)])]),suffix:d(()=>[l(N,{icon:o.value,size:18},null,8,["icon"])]),_:1},8,["value"])]),footer:d(()=>[...m[2]||(m[2]=[B(" 更多图标去 ",-1),R("a",{class:"text-blue",target:"_blank",href:"https://icones.js.org/collection/all"}," Icones ",-1),B(" 查看 ",-1)])]),default:d(()=>[f.value.length?(v(),w("ul",re,[(v(!0),w(Y,null,Z(f.value,(y,I)=>(v(),w("li",{key:I,class:"mx-5 inline-block cursor-pointer hover:text-cyan",onClick:n=>k(y)},[l(N,{icon:y,size:18},null,8,["icon"])],8,se))),128))])):(v(),w("div",pe,[l(N,{icon:o.value,size:18},null,8,["icon"])]))]),_:1})]))}},qe=Object.assign({name:"菜单管理"},{__name:"index",setup(z){const h=_(null),s=_({}),p=ie("permission"),o={order:1,keepalive:!0},{modalVisible:f,modalTitle:b,modalLoading:k,handleAdd:u,handleDelete:m,handleEdit:y,handleSave:I,modalForm:n,modalFormRef:P}=J({name:"菜单",initForm:o,doCreate:g.createMenu,doDelete:g.deleteMenu,doUpdate:g.updateMenu,refresh:()=>{var i;return(i=h.value)==null?void 0:i.handleSearch()}});te(()=>{var i;(i=h.value)==null||i.handleSearch(),V()});const M=_(!1),F=_([]),A=[{title:"ID",key:"id",width:50,ellipsis:{tooltip:!0},align:"center"},{title:"菜单名称",key:"name",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"菜单类型",key:"menu_type",width:80,align:"center",ellipsis:{tooltip:!0},render(i){let t=!1,a=!1;return i.menu_type==="catalog"?(a=!0,t=!1):i.menu_type==="menu"&&(a=!1,t=!0),c(ne,{type:"primary",round:t,bordered:a},{default:()=>i.menu_type==="catalog"?"目录":"菜单"})}},{title:"图标",key:"icon",width:40,align:"center",render(i){return c(N,{icon:i.icon,size:20})}},{title:"排序",key:"order",width:40,ellipsis:{tooltip:!0},align:"center"},{title:"访问路径",key:"path",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"跳转路径",key:"redirect",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"组件路径",key:"component",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"保活",key:"keepalive",width:40,align:"center",render(i){return c(C,{size:"small",rubberBand:!1,value:i.keepalive,onUpdateValue:()=>K(i)})}},{title:"隐藏",key:"is_hidden",width:40,align:"center",render(i){return c(C,{size:"small",rubberBand:!1,value:i.is_hidden,onUpdateValue:()=>L(i)})}},{title:"创建日期",key:"created_at",width:80,align:"center",render(i){return c("span",oe(i.created_at))}},{title:"操作",key:"actions",width:120,align:"center",fixed:"right",render(i){return[$(c(q,{size:"tiny",quaternary:!0,type:"primary",style:`display: ${i.children&&i.menu_type!=="menu"?"":"none"};`,onClick:()=>{o.parent_id=i.id,o.menu_type="menu",M.value=!1,u()}},{default:()=>"子菜单",icon:S("material-symbols:add",{size:16})}),[[p,"post/api/v1/menu/create"]]),$(c(q,{size:"tiny",quaternary:!0,type:"info",onClick:()=>{M.value=!1,y(i)}},{default:()=>"编辑",icon:S("material-symbols:edit-outline",{size:16})}),[[p,"post/api/v1/menu/update"]]),c(H,{onPositiveClick:()=>m({id:i.id},!1)},{trigger:()=>$(c(q,{size:"tiny",quaternary:!0,type:"error",style:`display: ${i.children&&i.children.length>0?"none":""};`},{default:()=>"删除",icon:S("material-symbols:delete-outline",{size:16})}),[[p,"delete/api/v1/menu/delete"]]),default:()=>c("div",{},"确定删除该菜单吗?")})]}}];function K(i){return U(this,null,function*(){i.id&&(i.publishing=!0,i.keepalive=i.keepalive===!1,yield g.updateMenu(i),i.publishing=!1,$message==null||$message.success(i.keepalive?"已开启":"已关闭"))})}function L(i){return U(this,null,function*(){i.id&&(i.publishing=!0,i.is_hidden=i.is_hidden===!1,yield g.updateMenu(i),i.publishing=!1,$message==null||$message.success(i.is_hidden?"已隐藏":"已取消隐藏"))})}function O(){o.parent_id=0,o.menu_type="catalog",o.is_hidden=!1,o.order=1,o.keepalive=!0,M.value=!0,u()}function V(){return U(this,null,function*(){const{data:i}=yield g.getMenus(),t={id:0,name:"根目录",children:[]};t.children=i,F.value=[t]})}return(i,t)=>(v(),D(E,{"show-footer":"",title:"菜单列表"},{action:d(()=>[$((v(),D(e(q),{type:"primary",onClick:O},{default:d(()=>[l(N,{icon:"material-symbols:add",size:18,class:"mr-5"}),t[13]||(t[13]=B("新建根菜单 ",-1))]),_:1})),[[e(p),"post/api/v1/menu/create"]])]),default:d(()=>[l(W,{ref_key:"$table",ref:h,"query-items":s.value,"onUpdate:queryItems":t[0]||(t[0]=a=>s.value=a),"is-pagination":!1,columns:A,"get-data":e(g).getMenus,"single-line":!0},null,8,["query-items","get-data"]),l(G,{visible:e(f),"onUpdate:visible":t[11]||(t[11]=a=>le(f)?f.value=a:null),title:e(b),loading:e(k),onSave:t[12]||(t[12]=a=>e(I)(V))},{default:d(()=>[l(e(de),{ref_key:"modalFormRef",ref:P,"label-placement":"left","label-align":"left","label-width":80,model:e(n)},{default:d(()=>[l(e(r),{label:"菜单类型",path:"menu_type"},{default:d(()=>[l(e(Q),{value:e(n).menu_type,"onUpdate:value":t[1]||(t[1]=a=>e(n).menu_type=a)},{default:d(()=>[l(e(j),{label:"目录",value:"catalog"}),l(e(j),{label:"菜单",value:"menu"})]),_:1},8,["value"])]),_:1}),l(e(r),{label:"上级菜单",path:"parent_id"},{default:d(()=>[l(e(ue),{value:e(n).parent_id,"onUpdate:value":t[2]||(t[2]=a=>e(n).parent_id=a),"key-field":"id","label-field":"name",options:F.value,"default-expand-all":"true"},null,8,["value","options"])]),_:1}),l(e(r),{label:"菜单名称",path:"name",rule:{required:!0,message:"请输入唯一菜单名称",trigger:["input","blur"]}},{default:d(()=>[l(e(x),{value:e(n).name,"onUpdate:value":t[3]||(t[3]=a=>e(n).name=a),placeholder:"请输入唯一菜单名称"},null,8,["value"])]),_:1}),l(e(r),{label:"访问路径",path:"path",rule:{required:!0,message:"请输入访问路径",trigger:["blur"]}},{default:d(()=>[l(e(x),{value:e(n).path,"onUpdate:value":t[4]||(t[4]=a=>e(n).path=a),placeholder:"请输入访问路径"},null,8,["value"])]),_:1}),e(n).menu_type==="menu"?(v(),D(e(r),{key:0,label:"组件路径",path:"component"},{default:d(()=>[l(e(x),{value:e(n).component,"onUpdate:value":t[5]||(t[5]=a=>e(n).component=a),placeholder:"请输入组件路径，例如：/system/user"},null,8,["value"])]),_:1})):ae("",!0),l(e(r),{label:"跳转路径",path:"redirect"},{default:d(()=>[l(e(x),{value:e(n).redirect,"onUpdate:value":t[6]||(t[6]=a=>e(n).redirect=a),disabled:e(n).parent_id!==0,placeholder:e(n).parent_id!==0?"只有一级菜单可以设置跳转路径":"请输入跳转路径"},null,8,["value","disabled","placeholder"])]),_:1}),l(e(r),{label:"菜单图标",path:"icon"},{default:d(()=>[l(fe,{value:e(n).icon,"onUpdate:value":t[7]||(t[7]=a=>e(n).icon=a)},null,8,["value"])]),_:1}),l(e(r),{label:"显示排序",path:"order"},{default:d(()=>[l(e(me),{value:e(n).order,"onUpdate:value":t[8]||(t[8]=a=>e(n).order=a),min:1},null,8,["value"])]),_:1}),l(e(r),{label:"是否隐藏",path:"is_hidden"},{default:d(()=>[l(e(C),{value:e(n).is_hidden,"onUpdate:value":t[9]||(t[9]=a=>e(n).is_hidden=a)},null,8,["value"])]),_:1}),l(e(r),{label:"KeepAlive",path:"keepalive"},{default:d(()=>[l(e(C),{value:e(n).keepalive,"onUpdate:value":t[10]||(t[10]=a=>e(n).keepalive=a)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","loading"])]),_:1}))}});export{qe as default};
